using System.Text.RegularExpressions;
using Lewiss.Pricing.Data.FabricData;
using Xunit.Abstractions;

namespace Lewiss.Pricing.Api.Tests.Systems.Utility;

public class FabricDataUtilityTests
{
    private readonly ITestOutputHelper _logger;
    public FabricDataUtilityTests(ITestOutputHelper logger)
    {
        _logger = logger;
    }



    [Fact]
    public async Task GetJSONFileListData_ShouldReturnJSONData_WhenSuppliedKineticsRollerFabricJSONFileData()
    {
        var fileName = KineticsRollerFabricGenerator.JSONFabricFilePath;
        var result = FabricDataUtility.GetJSONFileListData<KineticsRollerFabricDataJSONStructure>(fileName);

        Assert.NotNull(result);
        Assert.IsType<List<KineticsRollerFabricDataJSONStructure>>(result);
        Assert.NotEmpty(result);

    }

    [Fact]
    public async Task TransformData()
    {
        List<string> dataIn = [

"298 298 298 323 341 358 371 390 406 424 441 457 474 487 516 519 541 559 589 603 715 729 750 767 783 802 821",
"298 298 298 323 341 358 371 390 406 424 441 457 474 487 516 519 541 559 589 603 715 729 750 767 783 802 821",
"298 298 298 323 341 358 371 390 406 424 441 457 474 487 516 519 541 559 589 603 715 729 750 767 783 802 821",
"306 306 306 333 350 365 385 401 420 436 454 471 489 501 524 541 562 576 606 627 735 754 770 783 802 820 838",
"312 312 312 338 358 374 395 409 433 449 468 482 506 524 546 560 578 599 629 643 761 774 797 810 834 850 866",
"319 319 319 347 366 384 404 424 443 460 482 498 522 541 560 581 599 616 653 669 778 801 823 844 864 891 918",
"328 328 328 355 377 390 417 435 454 474 494 516 533 554 578 597 618 635 670 689 804 823 845 864 886 907 928",
"334 334 334 361 384 404 428 444 470 482 511 530 552 571 595 614 637 656 692 713 826 850 872 891 915 934 953",
"341 341 341 369 392 416 436 457 478 498 525 546 568 589 610 632 654 675 715 734 851 872 893 917 936 960 984",
"347 347 347 379 401 422 446 468 490 514 535 560 586 605 634 653 675 694 731 759 875 893 920 942 963 985 1007",
"354 354 354 382 409 433 454 479 501 527 552 571 600 622 643 670 694 716 756 778 893 920 942 961 985 1007    1029",
"360 360 360 390 419 441 468 489 517 536 567 589 614 638 669 689 715 737 777 799 918 944 966 991 1019    1042    1065",
"368 368 368 401 428 452 478 501 527 554 581 605 634 656 681 710 734 756 796 821 941 968 991 1023    1050    1079    1108",
"374 374 374 408 438 460 490 514 544 568 595 622 645 675 699 740 754 777 815 934 963 996 1019    1055    1084    1112    1140",
"379 379 379 419 444 473 500 525 554 581 606 635 669 691 729 759 772 796 836 955 987 1020    1044    1077    1111    1141    1171",
"384 384 384 425 452 482 514 535 564 592 624 651 686 710 751 777 793 815 945 974 1009    1046    1069    1119    1138    1170    1202",
"390 390 390 436 460 492 524 549 583 602 637 656 705 727 767 797 810 836 964 999 1033    1073    1096    1147    1168    1197    1226",
"396 396 396 443 473 506 535 559 589 614 651 676 724 750 788 818 834 945 985 1019    1055    1098    1124    1181    1197    1225    1253",
"403 403 403 451 479 516 548 570 599 626 665 689 746 766 804 837 851 964 1004    1041    1081    1125    1146    1211    1225    1257    1289",
"408 408 408 460 487 527 556 584 610 637 678 707 762 785 824 855 963 985 1023    1061    1104    1147    1173    1244    1257    1287    1317",
"416 416 416 470 495 536 570 592 622 646 691 718 783 804 844 875 980 1004    1042    1084    1127    1174    1198    1275    1289    1316    1343",
"419 419 419 476 506 549 581 605 634 657 707 729 802 823 859 987 1003    1023    1061    1106    1147    1201    1224    1306    1319    1349    1379",
"425 425 425 482 513 560 595 614 643 672 718 746 823 842 879 1007    1020    1042    1082    1127    1170    1225    1252    1337    1351    1381    1411",
"433 433 433 492 524 571 603 627 654 680 734 761 842 858 991 1031    1041    1061    1101    1146    1192    1254    1276    1369    1384    1416    1448",
"436 436 436 500 529 584 613 638 669 689 750 777 861 877 1009    1046    1058    1082    1120    1168    1217    1278    1302    1399    1419    1446    1473",
"441 441 441 509 536 597 627 646 676 705 762 788 879 990 1028    1065    1081    1101    1138    1189    1240    1305    1329    1432    1454    1481    1508",

];



        foreach (var row in dataIn)
        {
            var trimmed = row.Trim();
            var split = Regex.Split(trimmed, @"\s+");
            var joined = string.Join(",", split);
            var toArray = $"[{joined}],";
            _logger.WriteLine(toArray);
        }


    }


}